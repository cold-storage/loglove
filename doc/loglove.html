<!DOCTYPE html>

<html>
<head>
  <title>loglove</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="loglove">loglove</h1>
<p>A simple logging facility for node.js.</p>
<p>Allows for multiple loggers each with its own level.</p>
<p>Configuration is easy and can be changed at runtime.</p>
<p>Here&#39;s how you use the default logger.</p>
<pre><code>log = require(&#39;loglove&#39;).log()</code></pre>
<p>If you want multiple loggers, give each one a name.</p>
<pre><code>log = require(&#39;loglove&#39;).log(&#39;/my/log/name.js&#39;)</code></pre>
<p>We look for a configuration file at
<code>process.env.LOG_LOVE_CONFIG_FILE</code>, or you can just pass your config
to <code>require(&#39;loglove&#39;).configure()</code></p>
<p>You can easily set your logger names to the source file name.</p>
<pre><code>log = require(&#39;loglove&#39;).log(__filename)</code></pre>
<p>If you use this method you probably want to set the <code>LOG_LOVE_ROOT_PATH</code>
environment variable to the base path of your app so your logger names
are relative to that.</p>
<p>You can safely use loglove in library modules provided you use hard coded
log names and specify <code>OFF</code> as the level.</p>
<pre><code>log = require(&#39;loglove&#39;).log(&#39;/us/jsks/somelib.js&#39;, &#39;OFF&#39;)</code></pre>
<p>Now your library won&#39;t log anything unless your clients configure it to do so.</p>
<p>We only log to <code>stdout</code>. Let your ops guys take it from there.
They can send it to <a href="http://www.loggly.com">http://www.loggly.com</a>,
<a href="https://papertrailapp.com">https://papertrailapp.com</a>, or <a href="http://www.splunk.com">http://www.splunk.com</a></p>
<p>See: <a href="http://adam.heroku.com/past/2011/4/1/logs_are_streams_not_files">http://adam.heroku.com/past/2011/4/1/logs_are_streams_not_files</a> for the
rationale.</p>
<p>This should work fine unless you want to log different levels or formats
to different outputs.</p>
<p>Let me know what you think:
john curleya johnandkerri littleroundthing com</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> ll = {},
  fmt = require(<span class="string">'util'</span>).format,
  fs = require(<span class="string">'fs'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="configure">configure</h2>
<p>Takes a JSON string or object configuration like so.</p>
<pre><code>{ &quot;/some/logger.js&quot;: &quot;INFO&quot;, &quot;/&quot;: &quot;ERROR&quot; }</code></pre>
<p><code>&quot;/some/logger.js&quot;: &quot;INFO&quot;</code> sets the logger named <code>/some/logger.js</code>
to the <code>INFO</code> level.</p>
<p><code>&quot;/&quot;: &quot;ERROR&quot;</code> sets the logger with the name <code>/</code> to the <code>ERROR</code>
level. It also sets the default level (which is <code>INFO</code> if you haven&#39;t
changed it). All loggers will use the default level unless you specify
otherwise.</p>
<p>You can also configure <code>RELOAD_INTERVAL_SECONDS</code>.</p>
<pre><code>{ &quot;RELOAD_INTERVAL_SECONDS&quot;: 60 }</code></pre>
<p>In conjunction with <code>process.env.LOG_LOVE_CONFIG_FILE</code> this will cause
the <code>LOG_LOVE_CONFIG_FILE</code> to be reloaded periodically.</p>
<p>TODO Allow setting <code>LOG_LOVE_ROOT_PATH</code> after loggers have been created.
make <code>LOG_LOVE_ROOT_PATH</code> part of normal config. So only thing that
has to go in <code>process.env</code> is <code>LOG_LOVE_CONFIG_FILE</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>exports.configure = <span class="function"><span class="keyword">function</span><span class="params">(config)</span> {</span>
  <span class="keyword">if</span> (<span class="keyword">typeof</span> config === <span class="string">'string'</span> || config === String) {
    config = JSON.parse(config);
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>merge new config with existing config</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> config) {
    ll.config[key] = config[key];
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>configure each logger based on merged config</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">for</span> (<span class="keyword">var</span> logName <span class="keyword">in</span> ll.logmap) {
    ll.logmap[logName].__configure();
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>set default level if configured</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">if</span> (ll.config[<span class="string">'/'</span>]) {
    ll.DEFAULT_LEVEL = ll.config[<span class="string">'/'</span>];
  }
  <span class="keyword">if</span> (ll.config[<span class="string">'RELOAD_INTERVAL_SECONDS'</span>] &amp;&amp; process.env.LOG_LOVE_CONFIG_FILE) {</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>reload config on a given interval</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
      fs.readFile(process.env.LOG_LOVE_CONFIG_FILE, {
        encoding: <span class="string">'utf8'</span>
      }, <span class="function"><span class="keyword">function</span><span class="params">(err, cfg)</span> {</span>
        <span class="keyword">if</span> (!err) {
          exports.configure(cfg);
        }
      });

    }, ll.config[<span class="string">'RELOAD_INTERVAL_SECONDS'</span>] * <span class="number">1000</span>);
  }
  <span class="keyword">return</span> <span class="keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h2 id="formatter">formatter</h2>
<p>Sets the callback function that will format your log messages.
You can use this to add timestamps, <font color='red'>colors</font>,
log level, name, etc. to your log messages.
The callback will be called as follows.</p>
<pre><code>callback(levelName, loggerName, args);</code></pre>
<p><code>args</code> is the arguments that you passed to log.info(), log.debug(), etc.
This gives you complete control of your log messages.
To get started you can use a copy of the default formatter
in the __reset method below.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>exports.formatter = <span class="function"><span class="keyword">function</span> <span class="title">formatter</span><span class="params">(cb)</span> {</span>
  ll.formatter = cb;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h2 id="we-use-syslog-levels-">We use syslog levels.</h2>
<p><a href="http://en.wikipedia.org/wiki/Syslog">http://en.wikipedia.org/wiki/Syslog</a></p>
<p>??? Allow custom levels ???</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>ll.OFF = -<span class="number">1</span>;
ll.EMERGENCY = <span class="number">0</span>;
ll.ALERT = <span class="number">1</span>;
ll.CRITICAL = <span class="number">2</span>;
ll.ERROR = <span class="number">3</span>;
ll.WARNING = <span class="number">4</span>;
ll.NOTICE = <span class="number">5</span>;
ll.INFO = <span class="number">6</span>;
ll.DEBUG = <span class="number">7</span>;

ll.levelNames = [];
ll.levelNames[<span class="number">0</span>] = <span class="string">'EMERGENCY'</span>;
ll.levelNames[<span class="number">1</span>] = <span class="string">'ALERT'</span>;
ll.levelNames[<span class="number">2</span>] = <span class="string">'CRITICAL'</span>;
ll.levelNames[<span class="number">3</span>] = <span class="string">'ERROR'</span>;
ll.levelNames[<span class="number">4</span>] = <span class="string">'WARNING'</span>;
ll.levelNames[<span class="number">5</span>] = <span class="string">'NOTICE'</span>;
ll.levelNames[<span class="number">6</span>] = <span class="string">'INFO'</span>;
ll.levelNames[<span class="number">7</span>] = <span class="string">'DEBUG'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2 id="constructor">Constructor</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="function"><span class="keyword">function</span> <span class="title">Log</span><span class="params">(name, levelName, noshow)</span> {</span>
  name = name || <span class="string">'/'</span>;
  name = name.substr(ll.rootPath.length);</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>just return the logger if it already exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">if</span> (ll.logmap[name]) {
    <span class="keyword">return</span> ll.logmap[name];
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>the logger&#39;s name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">this</span>.name = name;
  <span class="keyword">this</span>.__configure();</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>the last message logged (mostly for unit testing)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">this</span>.__message = <span class="literal">null</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>if <code>noshow</code> is <code>true</code>, we do everything except actually log.
makes unit tests a bit less annoying.
<code>__message</code> still
gets set and you can check if it matches what you expect.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="keyword">this</span>.__noshow = noshow || <span class="literal">false</span>;
  ll.logmap[<span class="keyword">this</span>.name] = <span class="keyword">this</span>;
}</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <h2 id="log">log</h2>
<p>Returns the logger of your dreams. All params are optional.
<code>name</code> defaults to <code>/</code>. <code>level</code> defaults to the default level
which is <code>INFO</code> unless it has been changed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>exports.log = <span class="function"><span class="keyword">function</span> <span class="title">log</span><span class="params">(name, level, noshow)</span> {</span>
  <span class="keyword">return</span> <span class="keyword">new</span> Log(name, level, noshow);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h2 id="prototype">prototype</h2>
<p>Here&#39;s what you can do with a logger. Log level descriptions from
<a href="http://en.wikipedia.org/wiki/Syslog">http://en.wikipedia.org/wiki/Syslog</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Log.prototype = {</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <h3 id="emergency">emergency</h3>
<p>A &quot;panic&quot; condition usually affecting multiple apps/servers/sites.
At this level it would usually notify all tech staff on call.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  emergency: <span class="function"><span class="keyword">function</span> <span class="title">emergency</span><span class="params">(msg)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.__log(<span class="string">'EMERGENCY'</span>, arguments);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h3 id="alert">alert</h3>
<p>Should be corrected immediately, therefore notify staff who can fix
the problem. An example would be the loss of a primary ISP connection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  alert: <span class="function"><span class="keyword">function</span> <span class="title">alert</span><span class="params">(msg)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.__log(<span class="string">'ALERT'</span>, arguments);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <h3 id="critical">critical</h3>
<p>Should be corrected immediately, but indicates failure in a secondary
system, an example is a loss of a backup ISP connection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  critical: <span class="function"><span class="keyword">function</span> <span class="title">critical</span><span class="params">(msg)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.__log(<span class="string">'CRITICAL'</span>, arguments);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <h3 id="error">error</h3>
<p>Non-urgent failures, these should be relayed to developers or admins;
each item must be resolved within a given time.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  error: <span class="function"><span class="keyword">function</span> <span class="title">error</span><span class="params">(msg)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.__log(<span class="string">'ERROR'</span>, arguments);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <h3 id="warning">warning</h3>
<p>Warning messages, not an error, but indication that an error will occur
if action is not taken, e.g. file system 85% full - each item must be
resolved within a given time.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  warning: <span class="function"><span class="keyword">function</span> <span class="title">warning</span><span class="params">(msg)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.__log(<span class="string">'WARNING'</span>, arguments);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <h3 id="notice">notice</h3>
<p>Events that are unusual but not error conditions - might be summarized
in an email to developers or admins to spot potential problems
-- no immediate action required.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  notice: <span class="function"><span class="keyword">function</span> <span class="title">notice</span><span class="params">(msg)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.__log(<span class="string">'NOTICE'</span>, arguments);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <h3 id="info">info</h3>
<p>Normal operational messages - may be harvested for reporting, measuring
throughput, etc. -- no action required.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  info: <span class="function"><span class="keyword">function</span> <span class="title">info</span><span class="params">(msg)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.__log(<span class="string">'INFO'</span>, arguments);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <h3 id="debug">debug</h3>
<p>Info useful to developers for debugging the application, not useful
during operations.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  debug: <span class="function"><span class="keyword">function</span> <span class="title">debug</span><span class="params">(msg)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.__log(<span class="string">'DEBUG'</span>, arguments);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <h3 id="m">m</h3>
<p>m is for (m)ethod level log. Returns a child copy of this log.
The logger name is parent name + &#39;/&#39; + child name.
Handy if your source file has hundreds of methods in it, which often
seems to the case with JavaScript. We are chainable so you can do the
following.</p>
<pre><code>var mlog = log.m(&#39;fooMethod&#39;).info(&#39;entering fooMethod&#39;);
mlog.info(&#39;more logs for fooMethod&#39;);</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>  m: <span class="function"><span class="keyword">function</span> <span class="title">m</span><span class="params">(name, level, noshow)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">new</span> Log(<span class="keyword">this</span>.name + <span class="string">'/'</span> + name, level, noshow);
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <h3 id="__log">__log</h3>
<p>Private method that does the actually writing to stdout.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  __log: <span class="function"><span class="keyword">function</span><span class="params">(level, args)</span> {</span>
    <span class="keyword">if</span> (<span class="keyword">this</span>.level &gt;= ll[level]) {
      <span class="keyword">this</span>.__message = ll.formatter(level, <span class="keyword">this</span>.name, args);
      <span class="keyword">if</span> (!<span class="keyword">this</span>.__noshow) {
        process.stdout.write(<span class="keyword">this</span>.__message + <span class="string">'\n'</span>);
      }
    }
    <span class="keyword">return</span> <span class="keyword">this</span>;
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <h3 id="__configure">__configure</h3>
<p>Configures this logger based on current config settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  __configure: <span class="function"><span class="keyword">function</span> <span class="title">__configure</span><span class="params">()</span> {</span>
    <span class="keyword">this</span>.strength = -<span class="number">1</span>;
    <span class="keyword">var</span> key, val, keyNoSlashStar, strength;
    <span class="keyword">for</span> (key <span class="keyword">in</span> ll.config) {
      val = ll.config[key];
      <span class="keyword">if</span> (<span class="keyword">this</span>.name === key) {
        <span class="keyword">this</span>.__setLevel(val, <span class="number">100</span>);
      } <span class="keyword">else</span> <span class="keyword">if</span> (key.indexOf(<span class="string">'*'</span>) &gt; -<span class="number">1</span>) {
        keyNoSlashStar = key.substr(<span class="number">0</span>, key.length - <span class="number">2</span>);
        <span class="keyword">if</span> (<span class="keyword">this</span>.name === keyNoSlashStar) {
          <span class="keyword">this</span>.__setLevel(val, <span class="number">100</span>);
        } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>.name.indexOf(keyNoSlashStar) === <span class="number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>wildcard matches with more segments beat those with less so
<code>/foo/bar/*</code> beats <code>/foo/*</code> assuming your logger is named
<code>/foo/bar/zoo.js</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          strength = key.split(<span class="string">'/'</span>).length;
          <span class="keyword">if</span> (strength &gt; <span class="keyword">this</span>.strength) {
            <span class="keyword">this</span>.__setLevel(val, strength);
          }
        }
      }
    }
    <span class="keyword">if</span> (<span class="keyword">this</span>.strength === -<span class="number">1</span>) {
      <span class="keyword">this</span>.__setLevel();
    }
  },
  __setLevel: <span class="function"><span class="keyword">function</span> <span class="title">__setLevel</span><span class="params">(levelName, strength)</span> {</span>
    <span class="keyword">this</span>.strength = strength;</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>the numeric level</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">this</span>.level = ll[levelName] || ll.DEFAULT_LEVEL;</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>the string level name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="keyword">this</span>.levelName = levelName || ll.levelNames[<span class="keyword">this</span>.level];
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <h3 id="tostring">toString</h3>
<p>Pretty print the logger.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  toString: <span class="function"><span class="keyword">function</span> <span class="title">toString</span><span class="params">()</span> {</span>
    <span class="keyword">return</span> JSON.stringify(<span class="keyword">this</span>);
  }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <h2 id="tostring">toString</h2>
<p>Pretty print loglove.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>exports.toString = <span class="function"><span class="keyword">function</span> <span class="title">toString</span><span class="params">()</span> {</span>
  <span class="keyword">return</span> JSON.stringify({
    rootPath: ll.rootPath,
    config: ll.config,
    logmap: ll.logmap,
    formatter: ll.formatter + <span class="string">''</span>
  });
};</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <h2 id="__reset">__reset</h2>
<p>Handy for unit testing. Should not be used otherwise.</p>
<p>For unit testing you can modify <code>process.env.LOG_LOVE_ROOT_PATH</code>
or <code>process.env.LOG_LOVE_CONFIG_FILE</code> and then call <code>_reset()</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>exports.__reset = <span class="function"><span class="keyword">function</span> <span class="title">__reset</span><span class="params">()</span> {</span>
  ll.DEFAULT_LEVEL = ll.INFO;
  ll.logmap = {};
  ll.rootPath = process.env.LOG_LOVE_ROOT_PATH || <span class="string">''</span>;
  ll.config = <span class="literal">null</span>;
  <span class="keyword">if</span> (process.env.LOG_LOVE_CONFIG_FILE) {
    <span class="keyword">try</span> {
      ll.config = JSON.parse(fs.readFileSync(process.env.LOG_LOVE_CONFIG_FILE, {
        encoding: <span class="string">'utf8'</span>
      }));
    } <span class="keyword">catch</span> (e) {</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>intentionally ignore error</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    }
  }
  ll.config = ll.config || {};
  exports.configure(ll.config);</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Default formatter outputs date, level, message and logger name.</p>
<pre><code>2013-11-30T14:41:56.446Z INF My message here. /my/logger/name.js</code></pre>
<p>You can copy this and tweak it till your heart&#39;s content.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  ll.formatter = <span class="function"><span class="keyword">function</span><span class="params">(level, name, args)</span> {</span>
    <span class="keyword">var</span> msg = fmt.apply(<span class="literal">null</span>, args).replace(<span class="regexp">/\n|\r/g</span>, <span class="string">' '</span>);
    <span class="keyword">return</span> fmt(JSON.stringify(
        <span class="keyword">new</span> Date()).substr(<span class="number">1</span>, <span class="number">24</span>),
      level.substr(<span class="number">0</span>, <span class="number">3</span>),
      <span class="string">'\x1B[33m'</span> + msg + <span class="string">'\x1B[39m'</span>,
      name);
  };
};

exports.__reset();

<span class="keyword">new</span> Log(<span class="string">'/LOG_LOVE_SYSTEM_LOGGER'</span>).info(<span class="string">'loglove initialized'</span>);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
